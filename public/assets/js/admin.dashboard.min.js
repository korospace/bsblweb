function validateAddKategori(){let a=!0;return""==$("input#NewkategoriSampah").val()?(showAlert({message:"<strong>Masukan kategori baru !</strong>",btnclose:!0,type:"danger"}),a=!1):$("input#NewkategoriSampah").val().length>20&&(showAlert({message:"<strong>Kategori baru maximal 20 huruf !</strong>",btnclose:!0,type:"danger"}),a=!1),arrayKatSampah.forEach(t=>{t.name.toLowerCase()==$("input#NewkategoriSampah").val().toLowerCase().trim()&&(showAlert({message:"<strong>Kategori sudah tersedia !</strong>",btnclose:!0,type:"danger"}),a=!1)}),a}const getTotalSampah=async()=>{let a=await httpRequestGet(`${APIURL}/sampah/totalitem`);if(200===a.status){let t=a.data.data;for(const a in t)$(`#sampah-${a}`).html(t[a].total+" Kg")}},getLastTransaksi=async()=>{$("#transaksi-terbaru-notfound").addClass("d-none"),$("#table-transaksi-terbaru").addClass("d-none"),$("#transaksi-terbaru-spinner").removeClass("d-none");let a=await httpRequestGet(`${APIURL}/transaksi/lasttransaksi?limit=20`);if($("#table-transaksi-terbaru").removeClass("d-none"),$("#transaksi-terbaru-spinner").addClass("d-none"),404===a.status)$("#transaksi-terbaru-notfound").removeClass("d-none"),$("#transaksi-terbaru-notfound #text-notfound").html("belum ada transaksi");else if(200===a.status){let t="",e=a.data.data;e.forEach(a=>{let e=new Date(1e3*parseInt(a.date)),s=e.toLocaleString("en-US",{hour:"numeric",minute:"numeric"}),n=e.toLocaleString("en-US",{day:"numeric"}),i=e.toLocaleString("en-US",{month:"long"}),d=e.toLocaleString("en-US",{year:"numeric"}),r="setor"==a.type?`${a.type} sampah`:`${a.type} saldo`,l="",o="";"setor"==a.type?(l="text-success",o=`+${a.total_kg} kg`):"tarik"==a.type?(l="text-danger",o="uang"==a.jenis_saldo?`-Rp ${a.total_tarik}`:`-${a.total_tarik} g`):(l="text-warning",o=`Rp ${a.total_pindah}`),t+=`<tr>\n                <td class="align-middle text-sm">\n                    <span class="text-xs text-name font-weight-bold"> \n                        ${a.id_transaksi}\n                    </span>\n                </td>\n                <td class="align-middle text-sm">\n                    <span class="text-xs text-name font-weight-bold">\n                        ${a.nama_lengkap}\n                    </span>\n                </td>\n                <td class="align-middle text-sm">\n                    <span class="text-xs text-name font-weight-bold ${l}">\n                        ${r}\n                    </span>\n                </td>\n                <td class="align-middle text-sm">\n                    <span class="text-xs text-name font-weight-bold ${l}"> \n                        ${o}\n                    </span>\n                </td>\n                <td class="align-middle text-sm">\n                    <span class="text-xs text-name font-weight-bold">\n                    ${n}/${i}/${d} ${s}\n                    </span>\n                </td>\n            </tr>`}),$("#table-transaksi-terbaru tbody").html(t)}};let currentYear="";$(".filter-transaksi").on("input",function(a){chartGrafik.destroy(),currentYear=$("#filter-year").val(),getRekapTransaksi(currentYear)});const getRekapTransaksi=async a=>{$(".spinner-wraper").removeClass("d-none"),$("#transaksi-wraper").addClass("d-none");let t=await httpRequestGet(`${APIURL}/transaksi/rekapdata?year=${a}`);if($(".spinner-wraper").addClass("d-none"),$("#transaksi-wraper").removeClass("d-none"),404===t.status)updateGrafikSetor([],[]),$("#transaksi-wraper").html("<h6 class='opacity-6'>belum ada transaksi</h6>");else if(200===t.status){let a=[],e=[],s="",n=t.data.data;for(const t in n)a.push(t),e.push(n[t].totSampahMasuk),s+=`<li class="list-group-item border-0 p-0 border-radius-lg">\n                <div class="d-flex align-items-center justify-content-between px-1">\n                    <div class="d-flex flex-column" style="flex:1;">\n                        <h6 class="text-dark font-weight-bold text-sm">${n[t].date}</h6>\n                        <div class="d-flex mt-2 w-100">\n                            <i class="fas fa-dollar-sign text-xxs text-success mr-3">\n                               Rp ${kFormatter(n[t].totUangMasuk)}\n                            </i>\n                            <i class="fas fa-dollar-sign text-xxs text-danger mr-3">\n                               Rp ${kFormatter(n[t].totUangKeluar)}\n                            </i>\n                        </div>\n                        <div class="d-flex mt-2 w-100">\n                            <i class="fas fa-trash text-xxs text-success mr-3">\n                                ${n[t].totSampahMasuk} kg\n                            </i>\n                            <i class="fas fa-trash text-xxs text-danger mr-3">\n                                ${n[t].totSampahKeluar} kg\n                            </i>\n                            <i class="fas fa-coins text-xxs text-danger mr-3">\n                                ${n[t].totEmasKeluar} g\n                            </i>\n                        </div>\n                    </div>\n                    <a href='' class="btn btn-link text-dark text-sm mb-0 px-0 h-100">\n                        <i class="fas fa-file-pdf text-lg me-1"></i> PDF\n                    </a>\n                </div>\n                <hr class="horizontal dark">\n            </li>`;updateGrafikSetor(a,e),$("#transaksi-wraper").html(`<ul class="list-group h-100 w-100" style="font-family: 'qc-medium';">\n            ${s}\n        </ul>`)}};let chartGrafik="";const updateGrafikSetor=(a,t)=>{var e=document.getElementById("chart-line").getContext("2d");document.querySelector("#chart-line").style.width="100%",document.querySelector("#chart-line").style.height="340px",document.querySelector("#chart-line").style.maxHeight="340px";var s=e.createLinearGradient(0,230,0,50);s.addColorStop(1,"rgba(193,217,102,0.2)");var n=e.createLinearGradient(0,230,0,50);n.addColorStop(1,"rgba(193,217,102,0.2)");for(let t=a.length;t<10;t++)a.push(" ");chartGrafik=new Chart(e,{type:"line",data:{labels:a,datasets:[{label:"Kg",tension:.4,borderWidth:0,pointRadius:0,borderColor:"#c1d966",borderWidth:3,backgroundColor:s,fill:!0,data:t,maxBarThickness:6,minBarLength:6}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{grid:{drawBorder:!1,display:!0,drawOnChartArea:!0,drawTicks:!1,borderDash:[5,5]},ticks:{display:!0,padding:10,color:"#b2b9bf",beginAtZero:!0,font:{size:11,family:"Open Sans",style:"normal",lineHeight:2}}},x:{grid:{drawBorder:!1,display:!1,drawOnChartArea:!1,drawTicks:!1,borderDash:[5,5]},ticks:{display:!0,color:"#b2b9bf",padding:0,font:{size:11,family:"Open Sans",style:"normal",lineHeight:2}}}}}})};let arrayKatSampah=[];const getAllKatSampah=async()=>{$("#kategori-sampah-wraper").html(`<div class="position-absolute bg-white d-flex align-items-center justify-content-center" style="z-index: 10;top: 0;bottom: 0;left: 0;right: 0;">\n       <img src="${BASEURL}/assets/images/spinner.svg" style="width: 20px;" />\n   </div>`);let a=await httpRequestGet(`${APIURL}/kategori_sampah/getitem`);if(404===a.status)$("#kategori-sampah-wraper").html('<div class="position-absolute bg-white d-flex align-items-center justify-content-center" style="z-index: 10;top: 0;bottom: 0;left: 0;right: 0;">\n           <h6 tyle="opacity: 0.6;">kategori belum tersedia</h6>\n       </div>');else if(200===a.status){let t="",e=a.data.data;arrayKatSampah=a.data.data,e.forEach(a=>{let e=a.name.replace(/\s/g,"-");t+=`\n           <div class="w-100">\n               <div id="${e}" class="kategori-list w-100 d-flex justify-content-between align-items-center px-3 py-2 cursor-pointer">\n                   <div class="d-flex align-items-center text-md" onclick="changeKatSampahVal(this,'${a.name}')" style="flex: 1;">\n                       ${a.name} <i class="checklist fas fa-check-circle text-muted ml-2"></i>\n                   </div>\n                   <span class="add-item badge badge-danger border-radius-sm cursor-pointer"  onclick="hapusKatSampahVal(this,'${a.id}','${a.name}')">\n                       <i class="fas fa-trash text-white"></i>\n                   </span>\n               </div>\n               <hr class="horizontal dark mt-0">\n            </div>`}),$("#kategori-sampah-wraper").html(t)}},changeKatSampahVal=(a,t)=>{$(".kategori-list").removeClass("active"),$("#formAddEditSampah input[name=kategori]").val(t),a.parentElement.classList.add("active")};$("#btnAddKategoriSampah").on("click",async function(a){if(a.preventDefault(),validateAddKategori()){let a=new FormData;a.append("kategori_name",$("input#NewkategoriSampah").val().trim().toLowerCase()),$("#btnAddKategoriSampah #text").addClass("d-none"),$("#btnAddKategoriSampah #spinner").removeClass("d-none");let t=await httpRequestPost(`${APIURL}/kategori_sampah/additem`,a);$("#btnAddKategoriSampah #text").removeClass("d-none"),$("#btnAddKategoriSampah #spinner").addClass("d-none"),201===t.status&&($("input#NewkategoriSampah").val(""),getAllKatSampah(),showAlert({message:"<strong>Success...</strong> kategori berhasil ditambah!",btnclose:!1,type:"success"}),setTimeout(()=>{hideAlert()},3e3))}});let arrayJenisSampah=[];const getAllJenisSampah=async()=>{$("#search-sampah").val(""),$("#list-sampah-notfound").addClass("d-none"),$("#table-jenis-sampah").addClass("d-none"),$("#list-sampah-spinner").removeClass("d-none");let a=await httpRequestGet(`${APIURL}/sampah/getitem`);if($("#table-jenis-sampah").removeClass("d-none"),$("#list-sampah-spinner").addClass("d-none"),404===a.status)$("#list-sampah-notfound").removeClass("d-none"),$("#list-sampah-notfound #text-notfound").html("jenis sampah belum ditambah");else if(200===a.status){let t="",e=sortingSampah(a.data.data);arrayJenisSampah=e,e.forEach((a,e)=>{t+=`<tr class="text-xs">\n                 <td class="align-middle text-center py-3">\n                     <span class="font-weight-bold"> ${++e} </span>\n                 </td>\n                 <td class="align-middle text-center">\n                     <span class="font-weight-bold"> ${a.kategori} </span>\n                 </td>\n                 <td class="align-middle text-center">\n                    ${a.jenis}\n                 </td>\n                 <td class="align-middle text-center py-3">\n                     <span class="font-weight-bold">Rp. ${modifUang(a.harga)} </span>\n                 </td>\n                 <td class="align-middle text-center py-3">\n                     <span class="font-weight-bold"> ${a.jumlah} </span>\n                 </td>\n                 <td class="align-middle text-center">\n                     <span id="btn-hapus" class="badge badge-danger text-xxs pb-1 rounded-sm cursor-pointer" onclick="hapusSampah(this,'${a.id}')">hapus</span>\n                     <span id="btn-hapus" class="badge badge-warning text-xxs pb-1 rounded-sm cursor-pointer" data-toggle="modal" data-target="#modalAddEditSampah" onclick="openModalAddEditSmp('editasampah','${a.id}')">edit</span>\n                 </td>\n             </tr>`}),$("#table-jenis-sampah tbody").html(t)}},sortingSampah=a=>{let t=[],e={},s=[];a.forEach(a=>{t.includes(a.kategori)||t.push(a.kategori.replace(/\s/g,"_"))}),t.forEach(t=>{e[t]=a.filter(a=>a.kategori==t.replace(/_/g," "))});for(let a in e)e[a].forEach(a=>{s.push(a)});return s};$("#search-sampah").on("keyup",function(){let a="",t=[];t=""===$(this).val()?arrayJenisSampah:arrayJenisSampah.filter(a=>a.kategori.includes($(this).val())||a.jenis.includes($(this).val())),0==t.length?($("#list-sampah-notfound").removeClass("d-none"),$("#list-sampah-notfound #text-notfound").html("sampah tidak ditemukan")):($("#list-sampah-notfound").addClass("d-none"),$("#list-sampah-notfound #text-notfound").html(" "),t.forEach((t,e)=>{a+=`<tr class="text-xs">\n            <td class="align-middle text-center py-3">\n                <span class="font-weight-bold"> ${++e} </span>\n            </td>\n            <td class="align-middle text-center">\n                <span class="font-weight-bold"> ${t.kategori} </span>\n            </td>\n            <td class="align-middle text-center">\n               ${t.jenis}\n            </td>\n            <td class="align-middle text-center py-3">\n                <span class="font-weight-bold">Rp. ${modifUang(t.harga)} </span>\n            </td>\n            <td class="align-middle text-center py-3">\n                <span class="font-weight-bold"> ${t.jumlah} </span>\n            </td>\n            <td class="align-middle text-center">\n                <span id="btn-hapus" class="badge badge-danger text-xxs pb-1 rounded-sm cursor-pointer" onclick="hapusSampah(this,'${t.id}')">hapus</span>\n                <span id="btn-hapus" class="badge badge-warning text-xxs pb-1 rounded-sm cursor-pointer" data-toggle="modal" data-target="#modalAddEditSampah" onclick="openModalAddEditSmp('editasampah','${t.id}')">edit</span>\n            </td>\n        </tr>`})),$("#table-jenis-sampah tbody").html(a)});const clearInputForm=()=>{$("#formAddEditSampah .form-control").val("")},openModalAddEditSmp=(a,t=null)=>{let e="addsampah"==a?"tambah sampah":"edit sampah";if($("#modalAddEditSampah .modal-title").html(e),$("#formAddEditSampah .form-control").removeClass("is-invalid"),$("#formAddEditSampah .text-danger").html(""),$(".kategori-list").removeClass("active"),"addsampah"==a)$("#formAddEditSampah").attr("onsubmit","addSampah(this,event);"),$("#modalAddEditSampah .edit-item").addClass("d-none"),$("#modalAddEditSampah .add-item").removeClass("d-none"),clearInputForm();else{$("#formAddEditSampah").attr("onsubmit","editSampah(this,event);"),$("#modalAddEditSampah .edit-item").removeClass("d-none"),$("#modalAddEditSampah .add-item").addClass("d-none");let a=arrayJenisSampah.filter(a=>a.id==t);$("#formAddEditSampah #id").val(a[0].id),$("#formAddEditSampah #jenis").val(a[0].jenis),$("#formAddEditSampah #harga").val(a[0].harga),$("#formAddEditSampah #jumlah").val(a[0].jumlah),$("#formAddEditSampah #kategori").val(a[0].kategori);let e=a[0].kategori.replace(/\s/g,"-");$(`#kategori-sampah-wraper #${e}`).addClass("active"),currentKategori=a[0].kategori}},addSampah=async(a,t)=>{if(t.preventDefault(),doValidateAddSmp()){let t=new FormData(a);t.set("kategori",$("#formAddEditSampah input#kategori").val()),$("#formAddEditSampah #btn-add-edit-sampah #text").addClass("d-none"),$("#formAddEditSampah #btn-add-edit-sampah #spinner").removeClass("d-none");let e=await httpRequestPost(`${APIURL}/sampah/additem`,t);$("#formAddEditSampah #btn-add-edit-sampah #text").removeClass("d-none"),$("#formAddEditSampah #btn-add-edit-sampah #spinner").addClass("d-none"),201===e.status?($(".kategori-list").removeClass("active"),getAllJenisSampah(),clearInputForm(),showAlert({message:"<strong>Success...</strong> sampah berhasil ditambah!",btnclose:!1,type:"success"}),setTimeout(()=>{hideAlert()},3e3)):400===e.status&&e.message.jenis&&($("#formAddEditSampah #jenis").addClass("is-invalid"),$("#formAddEditSampah #jenis-error").text(e.message.jenis))}},editSampah=async(a,t)=>{if(t.preventDefault(),doValidateAddSmp()){let t=new FormData(a);t.set("kategori",$("#formAddEditSampah input#kategori").val()),$("#formAddEditSampah #btn-add-edit-sampah #text").addClass("d-none"),$("#formAddEditSampah #btn-add-edit-sampah #spinner").removeClass("d-none");let e=await httpRequestPut(`${APIURL}/sampah/edititem`,t);$("#formAddEditSampah #btn-add-edit-sampah #text").removeClass("d-none"),$("#formAddEditSampah #btn-add-edit-sampah #spinner").addClass("d-none"),201===e.status?(getAllJenisSampah(),showAlert({message:"<strong>Success...</strong> sampah berhasil diubah!",btnclose:!1,type:"success"}),setTimeout(()=>{hideAlert()},3e3)):400===e.status&&e.message.jenis&&($("#formAddEditSampah #jenis").addClass("is-invalid"),$("#formAddEditSampah #jenis-error").text(e.message.jenis))}},hapusKatSampahVal=(a,t,e)=>{Swal.fire({title:"ANDA YAKIN?",text:`semua sampah dengan kategori '${e}' akan ikut terhapus`,icon:"warning",showCancelButton:!0,confirmButtonText:"iya"}).then(s=>{s.isConfirmed&&Swal.fire({input:"password",inputAttributes:{autocapitalize:"off"},html:"<h5 class='mb-4'>Password</h5>",showCancelButton:!0,confirmButtonText:"submit",showLoaderOnConfirm:!0,preConfirm:s=>{let n=new FormData;return n.append("hashedpass",PASSADMIN),n.append("password",s),axios.post(`${APIURL}/admin/confirmdelete`,n,{headers:{}}).then(s=>($("#formAddEditSampah input[name=kategori]").val()==e&&$("#formAddEditSampah input[name=kategori]").val(""),httpRequestDelete(`${APIURL}/kategori_sampah/deleteitem?id=${t}`).then(e=>{201==e.status&&(a.parentElement.parentElement.remove(),arrayKatSampah=arrayKatSampah.filter(a=>a.id!=t),getAllJenisSampah())}))).catch(a=>{404==a.response.status?Swal.showValidationMessage("password salah"):500==a.response.status&&Swal.showValidationMessage("terjadi kesalahan, coba sekali lagi")})},allowOutsideClick:()=>!Swal.isLoading()})})},hapusSampah=(a,t)=>{Swal.fire({title:"ANDA YAKIN?",text:"Data akan terhapus permanen",icon:"warning",showCancelButton:!0,confirmButtonText:"iya"}).then(e=>{e.isConfirmed&&Swal.fire({input:"password",inputAttributes:{autocapitalize:"off"},html:"<h5 class='mb-4'>Password</h5>",showCancelButton:!0,confirmButtonText:"submit",showLoaderOnConfirm:!0,preConfirm:e=>{let s=new FormData;return s.append("hashedpass",PASSADMIN),s.append("password",e),axios.post(`${APIURL}/admin/confirmdelete`,s,{headers:{}}).then(e=>httpRequestDelete(`${APIURL}/sampah/deleteitem?id=${t}`).then(e=>{201==e.status&&(a.parentElement.parentElement.remove(),arrayJenisSampah=arrayJenisSampah.filter(a=>a.id!=t),0==arrayJenisSampah.length&&($("#list-sampah-notfound").removeClass("d-none"),$("#list-sampah-notfound #text-notfound").html("sampah belum ditambah")))})).catch(a=>{404==a.response.status?Swal.showValidationMessage("password salah"):500==a.response.status&&Swal.showValidationMessage("terjadi kesalahan, coba sekali lagi")})},allowOutsideClick:()=>!Swal.isLoading()})})},doValidateAddSmp=()=>{let a=!0;return $(".form-control").removeClass("is-invalid"),$(".text-danger").html(""),""==$("#formAddEditSampah #jenis").val()?($("#formAddEditSampah #jenis").addClass("is-invalid"),$("#formAddEditSampah #jenis-error").html("*jenis harus di isi"),a=!1):$("#formAddEditSampah #jenis").val().length>40&&($("#formAddEditSampah #jenis").addClass("is-invalid"),$("#formAddEditSampah #jenis-error").html("*maksimal 40 huruf"),a=!1),""==$("#formAddEditSampah #harga").val()?($("#formAddEditSampah #harga").addClass("is-invalid"),$("#formAddEditSampah #harga-error").html("*harga harus di isi"),a=!1):$("#formAddEditSampah #harga").val().length>11?($("#formAddEditSampah #harga").addClass("is-invalid"),$("#formAddEditSampah #harga-error").html("*maksimal 11 angka"),a=!1):/^\d+$/.test($("#formAddEditSampah #harga").val())||($("#formAddEditNasabah #harga").addClass("is-invalid"),$("#formAddEditNasabah #harga-error").html("*hanya boleh angka"),a=!1),$("#formAddEditSampah .edit-item").hasClass("d-none")||(""==$("#formAddEditSampah #jumlah").val()?($("#formAddEditSampah #jumlah").addClass("is-invalid"),$("#formAddEditSampah #jumlah-error").html("*jumlah harus di isi"),a=!1):$("#formAddEditSampah #jumlah").val().length>11?($("#formAddEditSampah #jumlah").addClass("is-invalid"),$("#formAddEditSampah #jumlah-error").html("*maksimal 11 angka"),a=!1):/[^0-9\.]/g.test($("#formAddEditSampah #jumlah").val())&&($("#formAddEditSampah #jumlah").addClass("is-invalid"),$("#formAddEditSampah #jumlah-error").html("*hanya boleh angka"),a=!1)),""==$("#formAddEditSampah #kategori").val()&&($("#formAddEditSampah #kategori").addClass("is-invalid"),a=!1),a},openModalJualSampah=()=>{$(".barisJualSampah").remove(),tambahBaris(),countTotalHarga(),$("#formJualSampah .form-control").removeClass("is-invalid"),$("#formJualSampah .text-danger").html(""),$("#formJualSampah .form-control").val("")},tambahBaris=(a=!1)=>{a&&a.preventDefault();let t="<option value='' data-harga='0' data-tersedia='0' selected>-- pilih jenis sampah  --</option>";0!==arrayJenisSampah.length&&arrayJenisSampah.forEach(a=>{t+=`<option value="${a.jenis}" data-harga="${a.harga}" data-tersedia="${a.jumlah}">${a.kategori} - ${a.jenis}</option>`});let e=$(".barisJualSampah").size(),s=` <td class="py-2" style="border-right: 0.5px solid #E9ECEF;">\n        <span class="w-100 btn btn-danger d-flex justify-content-center align-items-center border-radius-sm" style="height: 38px;margin: 0;" onclick="hapusBaris(this);">\n            <i class="fas fa-times text-white"></i>\n        </span>\n    </td>\n    <td class="py-2" style="border-right: 0.5px solid #E9ECEF;">\n        <select id="kategori-berita-wraper" class="inputJenisSampah form-control form-control-sm py-1 pl-2 border-radius-sm" name="transaksi[slot${e+1}][jenis_sampah]" style="min-height: 38px" onchange="getHargaInOption(this,event);">\n            ${t}\n        </select>\n    </td>\n    <td class="py-2 text-left" style="border-right: 0.5px solid #E9ECEF;">\n        <input type="text" class="inputJumlahSampah form-control form-control-sm pl-2 border-radius-sm" value="0" name="transaksi[slot${e+1}][jumlah]" style="min-height: 38px" onkeyup="countHargaXjumlah(this);">\n\n\t\t<small class="text-danger"></small>\n    </td>\n    <td class="py-2">\n        <input type="text" class="inputHargaSampah form-control form-control-sm pl-2 border-radius-sm" style="min-height: 38px" data-harga="0" value="0" disabled>\n    </td>`,n=document.createElement("tr");n.classList.add("barisJualSampah"),n.innerHTML=s,document.querySelector("#table-jual-sampah tbody").insertBefore(n,document.querySelector("#special-tr"))},hapusBaris=a=>{a.parentElement.parentElement.remove(),countTotalHarga()},getHargaInOption=(a,t)=>{var e=t.target.options[t.target.selectedIndex].dataset.harga,s=t.target.options[t.target.selectedIndex].dataset.tersedia;let n=a.parentElement.nextElementSibling.children[0];n.value=1,n.setAttribute("data-tersedia",s),n.classList.remove("is-invalid"),n.nextElementSibling.innerHTML="";let i=a.parentElement.nextElementSibling.nextElementSibling.children[0];i.value=e,i.setAttribute("data-harga",e),countTotalHarga()},countHargaXjumlah=a=>{var t=a.value;let e=a.parentElement.previousElementSibling.children[0];if(""!==e.value&&""!==t){let e=a.parentElement.nextElementSibling.children[0],s=e.getAttribute("data-harga");e.value=parseFloat(t)*parseFloat(s),countTotalHarga()}},countTotalHarga=()=>{let a=0;$(".inputHargaSampah").each(function(){a+=parseFloat($(this).val())}),$("#special-tr #total-harga").html(modifUang(a.toString()))},validateJualSampah=()=>{let a=!0,t="";return $("#formJualSampah .form-control").removeClass("is-invalid"),$("#formJualSampah .text-danger").html(""),""==$("#formJualSampah #date").val()&&($("#formJualSampah #date").addClass("is-invalid"),$("#formJualSampah #date-error").html("*tanggal harus di isi"),a=!1),$(".inputJenisSampah").each(function(){""==$(this).val()&&($(this).addClass("is-invalid"),a=!1,t="input tidak boleh kosong!")}),$(".inputJumlahSampah").each(function(){""==$(this).val()&&($(this).addClass("is-invalid"),a=!1,t="input tidak boleh kosong!"),/[^0-9\.]/g.test($(this).val())&&($(this).addClass("is-invalid"),a=!1,t="jumlah hanya boleh berupa angka positif dan titik!"),parseFloat($(this).val())>parseFloat($(this).attr("data-tersedia"))&&($(this).addClass("is-invalid"),$(this).siblings().html(`hanya tersedia ${$(this).attr("data-tersedia")} kg`),a=!1)}),0==a&&""!==t&&(showAlert({message:`<strong>${t}</strong>`,btnclose:!1,type:"danger"}),setTimeout(()=>{hideAlert()},3e3)),a},doTransaksi=async(a,t)=>{t.preventDefault();let e=a.parentElement.parentElement.parentElement;if(validateJualSampah()){Swal.fire({input:"password",inputAttributes:{autocapitalize:"off"},html:"<h5 class='mb-4'>Password</h5>",showCancelButton:!0,confirmButtonText:"submit",showLoaderOnConfirm:!0,preConfirm:t=>{let e=new FormData;return e.append("hashedpass",PASSADMIN),e.append("password",t),axios.post(`${APIURL}/admin/confirmdelete`,e,{headers:{}}).then(t=>{a()}).catch(a=>{404==a.response.status?Swal.showValidationMessage("password salah"):500==a.response.status&&Swal.showValidationMessage("terjadi kesalahan, coba sekali lagi")})},allowOutsideClick:()=>!Swal.isLoading()});let a=async()=>{let a=new FormData(e),t=a.get("date").split("-");a.set("date",`${t[2]}-${t[1]}-${t[0]}`),showLoadingSpinner(),httpResponse=await httpRequestPost(`${APIURL}/transaksi/jualsampah`,a),hideLoadingSpinner(),201===httpResponse.status&&(chartGrafik.destroy(),$("#formJualSampah .form-control").val(""),$("#formJualSampah .form-check-input").prop("checked",!1),$("#filter-year").val(t[0]),getRekapTransaksi(t[0]),$("#formJualSampah .barisJualSampah").remove(),tambahBaris(),countTotalHarga(),getAllJenisSampah(),showAlert({message:"<strong>Success...</strong> jual sampah berhasil!",btnclose:!1,type:"success"}),setTimeout(()=>{hideAlert()},3e3))}}};